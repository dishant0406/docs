---
title: Metadata Envelope
description: Thread and step metadata for DAG reconstruction.
---


Metadata links events into a decision DAG.

```json
{
  "_whyops": {
    "thread_id": "thread_abc123",
    "step_id": 4,
    "parent_step": 3,
    "span_id": "span_def456"
  }
}
```

## Why it matters

- Allows tool retries to be grouped under a single step
- Enables causal graphs instead of flat logs
- Preserves lineage across memory → LLM → tool chains
